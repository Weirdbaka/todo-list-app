<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Advanced To-Do ‚Äî Floating Dashboard</title>
<style>
  :root{
    --bg-1: #ffe4e1;
    --bg-2: linear-gradient(135deg,#0d1117,#555555);
    --card: #fff;
    --text: #222;
    --muted: #888;
    --accent: #b0c4de;
    --accent-2: #997a8d;
  }
  body {
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    margin:0;
    min-height:100vh;
    display:flex;
    align-items:flex-start;
    justify-content:center;
    padding:28px;
    background: var(--bg-1);
    color: var(--text);
    transition: background 350ms ease, color 350ms ease;
  }
  body.dark { background: var(--bg-2); color: #eaeaea; }

  
  .wrap { width:100%; max-width:720px; }

 
  .panel {
    background:var(--card);
    border-radius:12px;
    padding:18px;
    box-shadow:0 8px 22px rgba(2,6,23,0.12);
    transition: background 300ms ease;
  }
  body.dark .panel { background:#161616; }

  h1 { margin:0 0 10px 0; font-size:20px; }

  .top-row { display:flex; align-items:center; justify-content:space-between; }

  .theme-toggle {
    padding:7px 12px;
    border-radius:999px;
    border:none;
    background:var(--accent-2);
    color:#fff;
    cursor:pointer;
  }

  .input-row {
    display:flex; gap:10px; margin-top:12px; flex-wrap:wrap;
  }
  input[type="text"], input[type="date"] {
    padding:10px 12px;
    border-radius:8px;
    border:1px solid #ddd;
    flex:1; min-width:160px; font-size:14px;
  }
  body.dark input[type="text"], body.dark input[type="date"] {
    background:#222; color:#eee; border:1px solid #333;
  }
  button.btn {
    padding:10px 14px;
    border-radius:8px;
    border:none;
    cursor:pointer;
    background:var(--accent);
    color:white;
  }

  
  .progress-wrap { margin-top:14px; }
  .progress-text { font-size:13px; color:var(--muted); margin-bottom:6px; display:flex; justify-content:space-between; }
  .progress-track { width:100%; height:12px; background:#eee; border-radius:999px; overflow:hidden; }
  body.dark .progress-track { background:#262626; }
  .progress-fill { height:100%; width:0%; background:var(--accent-2); transition: width 600ms cubic-bezier(.2,.9,.2,1); }

  
  #task-list { list-style:none; padding:0; margin:14px 0 0 0; display:flex; flex-direction:column; gap:10px; }
  .task {
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:10px;
    border-radius:10px;
    background:#fafafa;
    border:1px solid #e9e9e9;
    transition: all 250ms ease;
  }
  body.dark .task { background:#1b1b1b; border-color:#2a2a2a; }
  .task:hover { transform: scale(1.01); }
  .task.completed .text { text-decoration:line-through; color:#999; }

  .left { display:flex; align-items:center; gap:10px; flex:1; min-width:0; }
  .checkbox {
    width:18px; height:18px; border-radius:5px; border:2px solid #ccc;
    display:flex; align-items:center; justify-content:center;
    cursor:pointer; font-size:12px;
  }
  .checkbox.checked { background:var(--accent); color:#fff; border-color:var(--accent); }

  .text { font-size:14px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
  .meta { font-size:12px; color:var(--muted); }
  .due.overdue { color:#d9534f; font-weight:600; }
  .due.soon { color:#ff8c1a; font-weight:600; }

  .actions { display:flex; gap:8px; }
  .action-btn { background:transparent; border:none; cursor:pointer; padding:4px 6px; border-radius:6px; }
  .action-btn:hover { background:rgba(0,0,0,0.05); }

  .sidebar {
    position: fixed;
    bottom: 20px;
    right: 20px;
    display: flex;
    flex-direction: column;
    gap: 12px;
    z-index: 1000;
  }
  .sidebar .card {
    width: 260px;
    height: 200px;
    padding:14px;
    border-radius:12px;
    background:rgba(255,255,255,0.85);
    box-shadow:0 8px 24px rgba(0,0,0,0.2);
    backdrop-filter: blur(8px);
  }
  body.dark .sidebar .card {
    background:rgba(30,30,30,0.85);
    box-shadow:0 8px 24px rgba(0,0,0,0.5);
  }
  @media (max-width:600px){
    .sidebar { display:none; }
  }

  .stats { display:flex; justify-content:space-between; gap:8px; margin-top:6px; }
  .stat { flex:1; text-align:center; background:rgba(0,0,0,0.03); border-radius:8px; padding:6px; }
  body.dark .stat { background:rgba(255,255,255,0.05); }
  .num { font-weight:700; font-size:16px; display:block; }
  .label { font-size:12px; color:var(--muted); }

  #confetti-canvas { position:fixed; pointer-events:none; left:0; top:0; width:100%; height:100%; z-index:9999; display:none; }
</style>
</head>
<body>
  <div class="wrap">
    <div class="panel">
      <div class="top-row">
        <h1>To-Do List</h1>
        <button class="theme-toggle" id="theme-toggle">üåô</button>
      </div>

      <div class="input-row">
        <input id="new-task" type="text" placeholder="Add a new task..." />
        <input id="due-date" type="date" />
        <button id="add-btn" class="btn">Add</button>
      </div>

      <div class="progress-wrap">
        <div class="progress-text">
          <span id="progress-summary">0 of 0 tasks done (0%)</span>
        </div>
        <div class="progress-track"><div id="progress-fill" class="progress-fill"></div></div>
      </div>

      <ul id="task-list"></ul>
    </div>
  </div>
  <div class="sidebar">
    <div class="card">
      <h3 style="margin:0 0 8px;">Dashboard</h3>
      <div class="stats">
        <div class="stat">
          <span class="num" id="stat-total">0</span>
          <span class="label">üìÖ Total</span>
        </div>
        <div class="stat">
          <span class="num" id="stat-completed">0</span>
          <span class="label">‚úÖ Done</span>
        </div>
        <div class="stat">
          <span class="num" id="stat-overdue">0</span>
          <span class="label">‚è∞ Overdue</span>
        </div>
      </div>
    </div>
  </div>

  <canvas id="confetti-canvas"></canvas>

<script>
const newTaskEl = document.getElementById('new-task');
const dueEl = document.getElementById('due-date');
const addBtn = document.getElementById('add-btn');
const taskListEl = document.getElementById('task-list');
const themeToggle = document.getElementById('theme-toggle');
const statTotal = document.getElementById('stat-total');
const statCompleted = document.getElementById('stat-completed');
const statOverdue = document.getElementById('stat-overdue');
const progressFill = document.getElementById('progress-fill');
const progressSummary = document.getElementById('progress-summary');
const confettiCanvas = document.getElementById('confetti-canvas');

let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
let darkMode = JSON.parse(localStorage.getItem('darkMode')) || false;

if (darkMode) document.body.classList.add('dark');
updateThemeIcon();

if ('Notification' in window && Notification.permission === 'default')
  Notification.requestPermission();

function saveTasks(){ localStorage.setItem('tasks', JSON.stringify(tasks)); }
function saveTheme(){ localStorage.setItem('darkMode', JSON.stringify(darkMode)); }

function renderTasks(){
  taskListEl.innerHTML='';
  tasks.forEach((t,i)=>{
    const li=document.createElement('li'); li.className='task';
    if(t.completed) li.classList.add('completed');

    const left=document.createElement('div'); left.className='left';
    const box=document.createElement('div');
    box.className='checkbox'+(t.completed?' checked':'');
    box.innerHTML=t.completed?'‚úì':''; box.addEventListener('click',e=>{e.stopPropagation();toggleTask(i);});
    const text=document.createElement('div'); text.className='text'; text.textContent=t.text;
    const meta=document.createElement('div'); meta.className='meta';
    const due=document.createElement('span'); due.className='due';
    if(t.dueDate){
      const now=new Date(), d=new Date(t.dueDate+'T23:59:59');
      const diff=d-now;
      if(!t.completed && diff<0) due.classList.add('overdue');
      else if(!t.completed && diff<86400000) due.classList.add('soon');
      due.textContent = (diff<0&&!t.completed)?`Overdue: ${t.dueDate}`:(diff<86400000&&!t.completed)?`Due soon: ${t.dueDate}`:`Due: ${t.dueDate}`;
    } else due.textContent='No due date';
    meta.appendChild(due);

    left.appendChild(box);
    const inner=document.createElement('div');
    inner.appendChild(text); inner.appendChild(meta);
    left.appendChild(inner);

    const actions=document.createElement('div'); actions.className='actions';
    const ebtn=document.createElement('button'); ebtn.className='action-btn'; ebtn.textContent='‚úèÔ∏è';
    ebtn.addEventListener('click',e=>{e.stopPropagation();editTask(i);});
    const dbtn=document.createElement('button'); dbtn.className='action-btn'; dbtn.textContent='üóëÔ∏è';
    dbtn.addEventListener('click',e=>{e.stopPropagation();deleteTask(i);});
    actions.append(ebtn,dbtn);

    li.append(left,actions);
    li.addEventListener('click',()=>toggleTask(i));

    li.draggable=true;
    li.addEventListener('dragstart',e=>{e.dataTransfer.setData('text/plain',i);});
    li.addEventListener('dragover',e=>e.preventDefault());
    li.addEventListener('drop',e=>{
      e.preventDefault();
      const from=+e.dataTransfer.getData('text/plain');
      if(from===i)return;
      const moved=tasks.splice(from,1)[0];
      tasks.splice(i,0,moved);
      saveTasks(); renderTasks();
    });

    taskListEl.appendChild(li);
  });
  updateStats();
}

function addTask(){
  const text=newTaskEl.value.trim(); if(!text)return;
  tasks.push({text, dueDate:dueEl.value||'', completed:false, notified:false});
  saveTasks(); renderTasks();
  newTaskEl.value=''; dueEl.value='';
}
function toggleTask(i){tasks[i].completed=!tasks[i].completed; saveTasks(); renderTasks(); checkAllDone();}
function editTask(i){
  const t=prompt('Edit task:',tasks[i].text);
  if(t!==null&&t.trim()!=='')tasks[i].text=t.trim();
  const d=prompt('Edit due date (YYYY-MM-DD):',tasks[i].dueDate);
  if(d!==null)tasks[i].dueDate=d.trim();
  saveTasks(); renderTasks();
}
function deleteTask(i){tasks.splice(i,1); saveTasks(); renderTasks();}

function updateStats(){
  const total=tasks.length;
  const done=tasks.filter(t=>t.completed).length;
  const overdue=tasks.filter(t=>{
    if(!t.dueDate||t.completed)return false;
    return new Date(t.dueDate+'T23:59:59')<new Date();
  }).length;
  statTotal.textContent=total;
  statCompleted.textContent=done;
  statOverdue.textContent=overdue;
  const pct=total?Math.round(done/total*100):0;
  progressFill.style.width=pct+'%';
  progressSummary.textContent=`${done} of ${total} tasks done (${pct}%)`;
}

function checkDue(){
  if(!('Notification'in window))return;
  const now=new Date();
  tasks.forEach(t=>{
    if(!t.dueDate||t.completed||t.notified)return;
    const due=new Date(t.dueDate+'T09:00:00');
    const diff=(due-now)/36e5;
    if(diff<=24&&diff>0&&Notification.permission==='granted'){
      new Notification('Task due soon',{body:t.text+' ‚Äî '+t.dueDate});
      t.notified=true; saveTasks();
    }
  });
}
setInterval(checkDue,60000); checkDue();

function checkAllDone(){
  if(tasks.length&&tasks.every(t=>t.completed)) showConfetti();
}

const ctx=confettiCanvas.getContext('2d');
function resize(){confettiCanvas.width=innerWidth;confettiCanvas.height=innerHeight;}
window.addEventListener('resize',resize);resize();
let confetti=[];
function showConfetti(){
  confettiCanvas.style.display='block';
  confetti=[]; for(let i=0;i<80;i++)
    confetti.push({x:Math.random()*innerWidth,y:Math.random()*-innerHeight,vx:(Math.random()-0.5)*4,vy:2+Math.random()*4,size:6+Math.random()*8,h:Math.random()*360});
  animate();
  setTimeout(()=>confettiCanvas.style.display='none',4000);
}
function animate(){
  ctx.clearRect(0,0,innerWidth,innerHeight);
  confetti.forEach(p=>{
    p.x+=p.vx; p.y+=p.vy; p.vy+=0.05;
    ctx.fillStyle=`hsl(${p.h},70%,50%)`;
    ctx.fillRect(p.x,p.y,p.size,p.size*0.6);
  });
  confetti=confetti.filter(p=>p.y<innerHeight);
  if(confetti.length)requestAnimationFrame(animate);
}

themeToggle.addEventListener('click',()=>{
  document.body.classList.toggle('dark');
  darkMode=document.body.classList.contains('dark');
  saveTheme(); updateThemeIcon();
});
function updateThemeIcon(){themeToggle.textContent=document.body.classList.contains('dark')?'‚òÄÔ∏è':'üåô';}

addBtn.addEventListener('click',addTask);
newTaskEl.addEventListener('keypress',e=>{if(e.key==='Enter')addTask();});
renderTasks();
</script>
</body>
</html>
